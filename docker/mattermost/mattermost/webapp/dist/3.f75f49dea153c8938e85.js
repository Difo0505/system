webpackJsonp([3],{1735:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(51),s=n(o),i=a(32),u=n(i),d=a(33),l=n(d),r=a(50),h=n(r),m=a(49),c=n(m),g=a(151),f=n(g),p=a(14),k=n(p),b=function(e){function t(){return(0,u.default)(this,t),(0,h.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){var e=[];return k.default.Children.forEach(this.props.children,function(t,a){0!==a&&e.push(k.default.createElement("span",{key:"divider"+a,className:"backstage-header__divider"},k.default.createElement("i",{className:"fa fa-angle-right"}))),e.push(t)}),k.default.createElement("div",{className:"backstage-header"},k.default.createElement("h1",null,e))}}],[{key:"propTypes",get:function(){return{children:f.default.node}}}]),t}(k.default.Component);t.default=b},1740:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(278),s=n(o),i=a(51),u=n(i),d=a(32),l=n(d),r=a(33),h=n(r),m=a(50),c=n(m),g=a(49),f=n(g),p=a(26),k=n(p),b=a(10),v=n(b),_=a(67),E=n(_),O=v.default.ActionTypes,y=function(e){function t(){(0,l.default)(this,t);var e=(0,c.default)(this,(t.__proto__||(0,u.default)(t)).call(this));return e.dispatchToken=k.default.register(e.handleEventPayload.bind(e)),e.incomingWebhooks=new s.default,e.outgoingWebhooks=new s.default,e.commands=new s.default,e.oauthApps=new s.default,e}return(0,f.default)(t,e),(0,h.default)(t,[{key:"addChangeListener",value:function(e){this.on("changed",e)}},{key:"removeChangeListener",value:function(e){this.removeListener("changed",e)}},{key:"emitChange",value:function(){this.emit("changed")}},{key:"hasReceivedIncomingWebhooks",value:function(e){return this.incomingWebhooks.has(e)}},{key:"getIncomingWebhooks",value:function(e){return this.incomingWebhooks.get(e)||[]}},{key:"setIncomingWebhooks",value:function(e,t){this.incomingWebhooks.set(e,t)}},{key:"addIncomingWebhook",value:function(e){var t=e.team_id,a=this.getIncomingWebhooks(t);a.push(e),this.setIncomingWebhooks(t,a)}},{key:"updateIncomingWebhook",value:function(e){for(var t=e.team_id,a=this.getIncomingWebhooks(t),n=0;n<a.length;n++)if(a[n].id===e.id){a[n]=e;break}this.setIncomingWebhooks(t,a)}},{key:"removeIncomingWebhook",value:function(e,t){var a=this.getIncomingWebhooks(e);a=a.filter(function(e){return e.id!==t}),this.setIncomingWebhooks(e,a)}},{key:"hasReceivedOutgoingWebhooks",value:function(e){return this.outgoingWebhooks.has(e)}},{key:"getOutgoingWebhooks",value:function(e){return this.outgoingWebhooks.get(e)||[]}},{key:"getOutgoingWebhook",value:function(e,t){return this.getOutgoingWebhooks(e).filter(function(e){return e.id===t})[0]}},{key:"setOutgoingWebhooks",value:function(e,t){this.outgoingWebhooks.set(e,t)}},{key:"addOutgoingWebhook",value:function(e){var t=e.team_id,a=this.getOutgoingWebhooks(t);a.push(e),this.setOutgoingWebhooks(t,a)}},{key:"updateOutgoingWebhook",value:function(e){for(var t=e.team_id,a=this.getOutgoingWebhooks(t),n=0;n<a.length;n++)if(a[n].id===e.id){a[n]=e;break}this.setOutgoingWebhooks(t,a)}},{key:"removeOutgoingWebhook",value:function(e,t){var a=this.getOutgoingWebhooks(e);a=a.filter(function(e){return e.id!==t}),this.setOutgoingWebhooks(e,a)}},{key:"hasReceivedCommands",value:function(e){return this.commands.has(e)}},{key:"getCommands",value:function(e){return this.commands.get(e)||[]}},{key:"getCommand",value:function(e,t){return this.getCommands(e).filter(function(e){return e.id===t})[0]}},{key:"setCommands",value:function(e,t){this.commands.set(e,t)}},{key:"addCommand",value:function(e){var t=e.team_id,a=this.getCommands(t);a.push(e),this.setCommands(t,a)}},{key:"updateCommand",value:function(e){for(var t=e.team_id,a=this.getCommands(t),n=0;n<a.length;n++)if(a[n].id===e.id){a[n]=e;break}this.setCommands(t,a)}},{key:"removeCommand",value:function(e,t){var a=this.getCommands(e);a=a.filter(function(e){return e.id!==t}),this.setCommands(e,a)}},{key:"hasReceivedOAuthApps",value:function(e){return this.oauthApps.has(e)}},{key:"getOAuthApps",value:function(e){return this.oauthApps.get(e)||[]}},{key:"setOAuthApps",value:function(e,t){this.oauthApps.set(e,t)}},{key:"addOAuthApp",value:function(e){var t=e.creator_id,a=this.getOAuthApps(t);a.push(e),this.setOAuthApps(t,a)}},{key:"removeOAuthApp",value:function(e,t){var a=this.getOAuthApps(e);a=a.filter(function(e){return e.id!==t}),this.setOAuthApps(e,a)}},{key:"handleEventPayload",value:function(e){var t=e.action;switch(t.type){case O.RECEIVED_INCOMING_WEBHOOKS:this.setIncomingWebhooks(t.teamId,t.incomingWebhooks),this.emitChange();break;case O.RECEIVED_INCOMING_WEBHOOK:this.addIncomingWebhook(t.incomingWebhook),this.emitChange();break;case O.UPDATED_INCOMING_WEBHOOK:this.updateIncomingWebhook(t.incomingWebhook),this.emitChange();break;case O.REMOVED_INCOMING_WEBHOOK:this.removeIncomingWebhook(t.teamId,t.id),this.emitChange();break;case O.RECEIVED_OUTGOING_WEBHOOKS:this.setOutgoingWebhooks(t.teamId,t.outgoingWebhooks),this.emitChange();break;case O.RECEIVED_OUTGOING_WEBHOOK:this.addOutgoingWebhook(t.outgoingWebhook),this.emitChange();break;case O.UPDATED_OUTGOING_WEBHOOK:this.updateOutgoingWebhook(t.outgoingWebhook),this.emitChange();break;case O.REMOVED_OUTGOING_WEBHOOK:this.removeOutgoingWebhook(t.teamId,t.id),this.emitChange();break;case O.RECEIVED_COMMANDS:this.setCommands(t.teamId,t.commands),this.emitChange();break;case O.RECEIVED_COMMAND:this.addCommand(t.command),this.emitChange();break;case O.UPDATED_COMMAND:this.updateCommand(t.command),this.emitChange();break;case O.REMOVED_COMMAND:this.removeCommand(t.teamId,t.id),this.emitChange();break;case O.RECEIVED_OAUTHAPPS:this.setOAuthApps(t.userId,t.oauthApps),this.emitChange();break;case O.RECEIVED_OAUTHAPP:this.addOAuthApp(t.oauthApp),this.emitChange();break;case O.REMOVED_OAUTHAPP:this.removeOAuthApp(t.userId,t.id),this.emitChange()}}}]),t}(E.default);t.default=new y},500:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(51),s=n(o),i=a(32),u=n(i),d=a(50),l=n(d),r=a(33),h=n(r),m=a(49),c=n(m),g=a(151),f=n(g),p=a(14),k=n(p),b=a(1735),v=n(b),_=a(197),E=a(58),O=a(22),y=n(O),M=a(1740),C=n(M),A=a(10),I=n(A),W=function(e){function t(e){(0,u.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));a.handleIntegrationChange=a.handleIntegrationChange.bind(a),a.handleKeyPress=a.handleKeyPress.bind(a);var n=y.default.getCurrentId();return a.state={type:a.props.location.query.type,id:a.props.location.query.id,oauthApps:C.default.getOAuthApps(n),loading:!C.default.hasReceivedOAuthApps(n)},a}return(0,c.default)(t,e),(0,h.default)(t,null,[{key:"propTypes",get:function(){return{team:f.default.object,location:f.default.object,loading:f.default.bool}}}]),(0,h.default)(t,[{key:"componentDidMount",value:function(){C.default.addChangeListener(this.handleIntegrationChange),window.addEventListener("keypress",this.handleKeyPress)}},{key:"componentWillUnmount",value:function(){C.default.removeChangeListener(this.handleIntegrationChange),window.removeEventListener("keypress",this.handleKeyPress)}},{key:"handleIntegrationChange",value:function(){var e=y.default.getCurrentId();this.setState({oauthApps:C.default.getOAuthApps(e),loading:!C.default.hasReceivedOAuthApps(e)})}},{key:"handleKeyPress",value:function(e){"Enter"===e.key&&E.browserHistory.push("/"+this.props.team.name+"/integrations/"+this.state.type)}},{key:"render",value:function(){var e=null,t=null,a=null;if(!0===this.props.loading)return k.default.createElement("div",null);if(this.state.type===I.default.Integrations.COMMAND)e=k.default.createElement(_.FormattedMessage,{id:"installed_commands.header",defaultMessage:"Slash Commands"}),t=k.default.createElement("p",null,k.default.createElement(_.FormattedHTMLMessage,{id:"add_command.doneHelp",defaultMessage:'Your slash command has been set up. The following token will be sent in the outgoing payload. Please use it to verify the request came from your Mattermost team (see <a href="https://docs.mattermost.com/developer/slash-commands.html">documentation</a> for further details).'})),a=k.default.createElement("p",{className:"word-break--all"},k.default.createElement(_.FormattedHTMLMessage,{id:"add_command.token",defaultMessage:"<b>Token</b>: {token}",values:{token:C.default.getCommand(this.props.team.id,this.state.id).token}}));else if(this.state.type===I.default.Integrations.INCOMING_WEBHOOK)e=k.default.createElement(_.FormattedMessage,{id:"installed_incoming_webhooks.header",defaultMessage:"Incoming Webhooks"}),t=k.default.createElement("p",null,k.default.createElement(_.FormattedHTMLMessage,{id:"add_incoming_webhook.doneHelp",defaultMessage:'Your incoming webhook has been set up. Please send data to the following URL (see <a href=\\"https://docs.mattermost.com/developer/webhooks-incoming.html\\">documentation</a> for further details).'})),a=k.default.createElement("p",{className:"word-break--all"},k.default.createElement(_.FormattedHTMLMessage,{id:"add_incoming_webhook.url",defaultMessage:"<b>URL</b>: {url}",values:{url:window.location.origin+"/hooks/"+this.state.id}}));else if(this.state.type===I.default.Integrations.OUTGOING_WEBHOOK)e=k.default.createElement(_.FormattedMessage,{id:"installed_outgoing_webhooks.header",defaultMessage:"Outgoing Webhooks"}),t=k.default.createElement("p",null,k.default.createElement(_.FormattedHTMLMessage,{id:"add_outgoing_webhook.doneHelp",defaultMessage:'Your outgoing webhook has been set up. The following token will be sent in the outgoing payload. Please use it to verify the request came from your Mattermost team (see <a href=\\"https://docs.mattermost.com/developer/webhooks-outgoing.html\\">documentation</a> for further details).'})),a=k.default.createElement("p",{className:"word-break--all"},k.default.createElement(_.FormattedHTMLMessage,{id:"add_outgoing_webhook.token",defaultMessage:"<b>Token</b>: {token}",values:{token:C.default.getOutgoingWebhook(this.props.team.id,this.state.id).token}}));else if(this.state.type===I.default.Integrations.OAUTH_APP){for(var n={},o=0;o<this.state.oauthApps.length;o++)if(this.state.oauthApps[o].id===this.state.id){n=this.state.oauthApps[o];break}n&&(e=k.default.createElement(_.FormattedMessage,{id:"installed_oauth_apps.header",defaultMessage:"OAuth 2.0 Applications"}),t=[],t.push(k.default.createElement("p",{key:"add_oauth_app.doneHelp"},k.default.createElement(_.FormattedHTMLMessage,{id:"add_oauth_app.doneHelp",defaultMessage:'Your OAuth 2.0 application has been set up. Please use the following Client ID and Client Secret when requesting authorization for your application (see <a href="https://docs.mattermost.com/developer/oauth-2-0-applications.html">documentation</a> for further details).'}))),t.push(k.default.createElement("p",{key:"add_oauth_app.clientId"},k.default.createElement(_.FormattedHTMLMessage,{id:"add_oauth_app.clientId",defaultMessage:"<b>Client ID:</b> {id}",values:{id:this.state.id}})," ",k.default.createElement("br",null),k.default.createElement(_.FormattedHTMLMessage,{id:"add_oauth_app.clientSecret",defaultMessage:"<b>Client Secret:</b> {secret}",values:{secret:n.client_secret}}))),t.push(k.default.createElement("p",{key:"add_oauth_app.doneUrlHelp"},k.default.createElement(_.FormattedHTMLMessage,{id:"add_oauth_app.doneUrlHelp",defaultMessage:"The following are your authorized redirect URL(s)."}))),a=k.default.createElement("p",{className:"word-break--all"},k.default.createElement(_.FormattedHTMLMessage,{id:"add_oauth_app.url",defaultMessage:"<b>URL(s)</b>: {url}",values:{url:n.callback_urls}})))}return k.default.createElement("div",{className:"backstage-content row"},k.default.createElement(v.default,null,k.default.createElement(E.Link,{to:"/"+this.props.team.name+"/integrations/"+this.state.type},e),k.default.createElement(_.FormattedMessage,{id:"integrations.add",defaultMessage:"Add"})),k.default.createElement("div",{className:"backstage-form backstage-form__confirmation"},k.default.createElement("h4",{className:"backstage-form__title"},k.default.createElement(_.FormattedMessage,{id:"integrations.successful",defaultMessage:"Setup Successful"})),t,a,k.default.createElement("div",{className:"backstage-form__footer"},k.default.createElement(E.Link,{className:"btn btn-primary",type:"submit",to:"/"+this.props.team.name+"/integrations/"+this.state.type},k.default.createElement(_.FormattedMessage,{id:"integrations.done",defaultMessage:"Done"})))))}}]),t}(k.default.Component);t.default=W}});
//# sourceMappingURL=3.f75f49dea153c8938e85.js.map