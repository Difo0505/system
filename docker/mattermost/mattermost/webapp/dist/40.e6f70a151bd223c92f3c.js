webpackJsonp([40],{1418:function(e,t,a){"use strict";(function(e){function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(94),l=s(n),i=a(51),o=s(i),u=a(32),d=s(u),m=a(50),c=s(m),f=a(33),p=s(f),v=a(49),h=s(v),E=a(1509),g=s(E),_=a(93),M=r(_),y=a(204),w=a(82),T=s(w),b=a(1640),N=a(114),S=a(28),I=r(S),k=a(10),U=s(k),F=a(151),L=s(F),C=a(14),q=s(C),A=a(197),x=a(58),P=a(1737),H=s(P),O=function(t){function a(e){(0,d.default)(this,a);var t=(0,c.default)(this,(a.__proto__||(0,o.default)(a)).call(this,e));return t.handleSubmit=t.handleSubmit.bind(t),t.getInviteInfo=t.getInviteInfo.bind(t),t.renderEmailSignup=t.renderEmailSignup.bind(t),t.isUserValid=t.isUserValid.bind(t),t.state=t.getInviteInfo(),t}return(0,h.default)(a,t),(0,p.default)(a,null,[{key:"propTypes",get:function(){return{location:L.default.object}}}]),(0,p.default)(a,[{key:"componentDidMount",value:function(){(0,y.trackEvent)("signup","signup_user_01_welcome")}},{key:"getInviteInfo",value:function(){var e=this.props.location.query.d,t=this.props.location.query.h,a=this.props.location.query.id,r="",s="",n="",l="",i=!0,o="",u=!1;if(t&&t.length>0){var d=JSON.parse(e);r=d.email,s=d.display_name,n=d.name,l=d.id,i=!1}else a&&a.length>0?(i=!0,(0,b.getInviteInfo)(a,function(e){e&&(o="",s=e.display_name,n=e.name,l=e.id)},function(){u=!0,o=q.default.createElement(A.FormattedMessage,{id:"signup_user_completed.invalid_invite",defaultMessage:"The invite link was invalid.  Please speak with your Administrator to receive an invitation."})}),i=!1,e=null,t=null):i=!1;return{data:e,hash:t,email:r,teamDisplayName:s,teamName:n,teamId:l,inviteId:a,loading:i,serverError:o,noOpenServerError:u}}},{key:"finishSignup",value:function(){var e=this;(0,N.loadMe)(function(){var t=e.props.location.query;M.loadDefaultLocale(),t.redirect_to?x.browserHistory.push(t.redirect_to):M.redirectUserToDefaultTeam()})}},{key:"handleSignupSuccess",value:function(e,t){var a=this;(0,y.trackEvent)("signup","signup_user_02_complete"),(0,N.loginById)(t.id,e.password,"",function(){a.state.hash>0&&T.default.setGlobalItem(a.state.hash,(0,l.default)({usedBefore:!0})),(0,N.loadMe)(function(){var e=a.props.location.query;e.redirect_to?x.browserHistory.push(e.redirect_to):M.redirectUserToDefaultTeam()})},function(t){"api.user.login.not_verified.app_error"===t.id?x.browserHistory.push("/should_verify_email?email="+encodeURIComponent(e.email)+"&teamname="+encodeURIComponent(a.state.teamName)):a.setState({serverError:t.message})})}},{key:"isUserValid",value:function(){var e=this.refs.email.value.trim();if(!e)return this.setState({nameError:"",emailError:q.default.createElement(A.FormattedMessage,{id:"signup_user_completed.required"}),passwordError:"",serverError:""}),!1;if(!I.isEmail(e))return this.setState({nameError:"",emailError:q.default.createElement(A.FormattedMessage,{id:"signup_user_completed.validEmail"}),passwordError:"",serverError:""}),!1;var t=this.refs.name.value.trim().toLowerCase();if(!t)return this.setState({nameError:q.default.createElement(A.FormattedMessage,{id:"signup_user_completed.required"}),emailError:"",passwordError:"",serverError:""}),!1;var a=I.isValidUsername(t);if("Cannot use a reserved word as a username."===a)return this.setState({nameError:q.default.createElement(A.FormattedMessage,{id:"signup_user_completed.reserved"}),emailError:"",passwordError:"",serverError:""}),!1;if(a)return this.setState({nameError:q.default.createElement(A.FormattedMessage,{id:"signup_user_completed.usernameLength",values:{min:U.default.MIN_USERNAME_LENGTH,max:U.default.MAX_USERNAME_LENGTH}}),emailError:"",passwordError:"",serverError:""}),!1;var r=this.refs.password.value,s=I.isValidPassword(r);return!s||(this.setState({nameError:"",emailError:"",passwordError:s,serverError:""}),!1)}},{key:"handleSubmit",value:function(e){var t=this;if(e.preventDefault(),this.isUserValid()){this.setState({nameError:"",emailError:"",passwordError:"",serverError:""});var a={email:this.refs.email.value.trim(),username:this.refs.name.value.trim().toLowerCase(),password:this.refs.password.value,allow_marketing:!0};(0,N.createUserWithInvite)(a,this.state.data,this.state.hash,this.state.inviteId,this.handleSignupSuccess.bind(this,a),function(e){t.setState({serverError:e.message})})}}},{key:"renderEmailSignup",value:function(){var t=null,a=q.default.createElement("span",{className:"help-block"},q.default.createElement(A.FormattedMessage,{id:"signup_user_completed.emailHelp",defaultMessage:"Valid email required for sign-up"})),r="form-group";this.state.emailError&&(t=q.default.createElement("label",{className:"control-label"},this.state.emailError),a="",r+=" has-error");var s=null,n=q.default.createElement("span",{className:"help-block"},q.default.createElement(A.FormattedMessage,{id:"signup_user_completed.userHelp",defaultMessage:"Username must begin with a letter, and contain between {min} to {max} lowercase characters made up of numbers, letters, and the symbols '.', '-' and '_'",values:{min:U.default.MIN_USERNAME_LENGTH,max:U.default.MAX_USERNAME_LENGTH}})),l="form-group";this.state.nameError&&(s=q.default.createElement("label",{className:"control-label"},this.state.nameError),n="",l+=" has-error");var i=null,o="form-group";this.state.passwordError&&(i=q.default.createElement("label",{className:"control-label"},this.state.passwordError),o+=" has-error");var u=null;this.state.email&&(u=q.default.createElement(A.FormattedHTMLMessage,{id:"signup_user_completed.emailIs",defaultMessage:"Your email address is <strong>{email}</strong>. You'll use this address to sign in to {siteName}.",values:{email:this.state.email,siteName:e.window.mm_config.SiteName}}));var d="margin--extra";return this.state.email&&(d="hidden"),q.default.createElement("form",null,q.default.createElement("div",{className:"inner__content"},q.default.createElement("div",{className:d},q.default.createElement("h5",null,q.default.createElement("strong",null,q.default.createElement(A.FormattedMessage,{id:"signup_user_completed.whatis",defaultMessage:"What's your email address?"}))),q.default.createElement("div",{className:r},q.default.createElement("input",{id:"email",type:"email",ref:"email",className:"form-control",defaultValue:this.state.email,placeholder:"",maxLength:"128",autoFocus:!0,spellCheck:"false",autoCapitalize:"off"}),t,a)),u,q.default.createElement("div",{className:"margin--extra"},q.default.createElement("h5",null,q.default.createElement("strong",null,q.default.createElement(A.FormattedMessage,{id:"signup_user_completed.chooseUser",defaultMessage:"Choose your username"}))),q.default.createElement("div",{className:l},q.default.createElement("input",{id:"name",type:"text",ref:"name",className:"form-control",placeholder:"",maxLength:U.default.MAX_USERNAME_LENGTH,spellCheck:"false",autoCapitalize:"off"}),s,n)),q.default.createElement("div",{className:"margin--extra"},q.default.createElement("h5",null,q.default.createElement("strong",null,q.default.createElement(A.FormattedMessage,{id:"signup_user_completed.choosePwd",defaultMessage:"Choose your password"}))),q.default.createElement("div",{className:o},q.default.createElement("input",{id:"password",type:"password",ref:"password",className:"form-control",placeholder:"",maxLength:"128",spellCheck:"false"}),i)),q.default.createElement("p",{className:"margin--extra"},q.default.createElement("button",{id:"createAccountButton",type:"submit",onClick:this.handleSubmit,className:"btn-primary btn"},q.default.createElement(A.FormattedMessage,{id:"signup_user_completed.create",defaultMessage:"Create Account"})))))}},{key:"render",value:function(){var t=null;if(this.state.serverError&&(t=q.default.createElement("div",{className:"form-group has-error"},q.default.createElement("label",{className:"control-label"},this.state.serverError))),this.state.loading)return q.default.createElement(g.default,null);var a=void 0;if("true"!==e.window.mm_config.EnableSignUpWithEmail)return null;a=this.renderEmailSignup();var r=null;!this.state.noOpenServerError&&a&&(r=q.default.createElement("p",null,q.default.createElement(A.FormattedHTMLMessage,{id:"create_team.agreement",defaultMessage:"By proceeding to create your account and use {siteName}, you agree to our <a href='{TermsOfServiceLink}'>Terms of Service</a> and <a href='{PrivacyPolicyLink}'>Privacy Policy</a>. If you do not agree, you cannot use {siteName}.",values:{siteName:e.window.mm_config.SiteName,TermsOfServiceLink:e.window.mm_config.TermsOfServiceLink,PrivacyPolicyLink:e.window.mm_config.PrivacyPolicyLink}}))),this.state.noOpenServerError&&(a=null);var s=null;return s="true"===e.window.mm_license.IsLicensed&&"true"===e.window.mm_license.CustomBrand&&"true"===e.window.mm_config.EnableCustomBrand?e.window.mm_config.CustomDescriptionText:q.default.createElement(A.FormattedMessage,{id:"web.root.signup_info",defaultMessage:"All team communication in one place, searchable and accessible anywhere"}),q.default.createElement("div",null,q.default.createElement("div",{className:"signup-header"},q.default.createElement(x.Link,{to:"/"},q.default.createElement("span",{className:"fa fa-chevron-left"}),q.default.createElement(A.FormattedMessage,{id:"web.header.back"}))),q.default.createElement("div",{className:"col-sm-12"},q.default.createElement("div",{className:"signup-team__container padding--less"},q.default.createElement("img",{className:"signup-team-logo",src:H.default}),q.default.createElement("h1",null,e.window.mm_config.SiteName),q.default.createElement("h4",{className:"color--light"},s),q.default.createElement("h4",{className:"color--light"},q.default.createElement(A.FormattedMessage,{id:"signup_user_completed.lets",defaultMessage:"Let's create your account"})),q.default.createElement("span",{className:"color--light"},q.default.createElement(A.FormattedMessage,{id:"signup_user_completed.haveAccount",defaultMessage:"Already have an account?"})," ",q.default.createElement(x.Link,{to:"/login",query:this.props.location.query},q.default.createElement(A.FormattedMessage,{id:"signup_user_completed.signIn",defaultMessage:"Click here to sign in."}))),a,t,r)))}}]),a}(q.default.Component);t.default=O}).call(t,a(16))},1509:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=a(51),n=r(s),l=a(32),i=r(l),o=a(33),u=r(o),d=a(50),m=r(d),c=a(49),f=r(c),p=a(197),v=a(151),h=r(v),E=a(14),g=r(E),_=function(e){function t(e){(0,i.default)(this,t);var a=(0,m.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return a.state={},a}return(0,f.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=g.default.createElement(p.FormattedMessage,{id:"loading_screen.loading",defaultMessage:"Loading"});return this.props.message&&(e=this.props.message),g.default.createElement("div",{className:"loading-screen",style:{position:this.props.position}},g.default.createElement("div",{className:"loading__content"},g.default.createElement("h3",null,e),g.default.createElement("div",{className:"round round-1"}),g.default.createElement("div",{className:"round round-2"}),g.default.createElement("div",{className:"round round-3"})))}}]),t}(g.default.Component);t.default=_,_.defaultProps={position:"relative"},_.propTypes={position:h.default.oneOf(["absolute","fixed","relative","static","inherit"]),message:h.default.node}},1640:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){(0,U.checkIfTeamExists)(e)(C,q).then(function(e){if(null!=e&&t)t(e);else if(null==e&&a){var r=q().requests.teams.getTeam.error;a((0,E.default)({id:r.server_error_id},r))}})}function n(e,t,a){(0,U.createTeam)(e)(C,q).then(function(e){if(e&&t)b.browserHistory.push("/"+e.name+"/channels/town-square"),t(e);else if(null==e&&a){var r=q().requests.teams.createTeam.error;a((0,E.default)({id:r.server_error_id},r))}})}function l(e,t,a){(0,U.updateTeam)(e)(C,q).then(function(e){if(e&&t)b.browserHistory.push("/"+e.name+"/channels/town-square"),t(e);else if(null==e&&a){var r=q().requests.teams.updateTeam.error;a((0,E.default)({id:r.server_error_id},r))}})}function i(e,t,a,r){(0,U.removeUserFromTeam)(e,t)(C,q).then(function(s){if((0,I.getUser)(t)(C,q),(0,U.getTeamStats)(e)(C,q),s&&a)a();else if(null==s&&r){var n=q().requests.teams.removeUserFromTeam.error;r((0,E.default)({id:n.server_error_id},n))}})}function o(e,t,a,r,s){(0,U.updateTeamMemberRoles)(e,t,a)(C,q).then(function(e){if(e&&r)r();else if(null==e&&s){var t=q().requests.teams.updateTeamMember.error;s((0,E.default)({id:t.server_error_id},t))}})}function u(e,t,a,r,s){T.default.addUserToTeamFromInvite(e,t,a,function(e){var t={team_id:e.id,user_id:q().entities.users.currentUserId,roles:"team_user",delete_at:0,msg_count:0,mention_count:0};C((0,L.batchActions)([{type:F.TeamTypes.RECEIVED_TEAMS_LIST,data:[e]},{type:F.TeamTypes.RECEIVED_MY_TEAM_MEMBER,data:t}])),r&&r(e)},function(e){s&&s(e)})}function d(e,t,a,r){(0,U.addUsersToTeam)(e,t)(C,q).then(function(e){if(e&&a)a(e);else if(null==e&&r){var t=q().requests.teams.addUserToTeam.error;r((0,E.default)({id:t.server_error_id},t))}})}function m(e,t,a){T.default.getInviteInfo(e,function(e){t&&t(e)},function(e){a&&a(e)})}function c(e,t,a){e.invites||t();var r=[];e.invites.forEach(function(e){r.push(e.email)}),(0,U.sendEmailInvitesToTeam)(_.default.getCurrentId(),r)(C,q).then(function(e){if(e&&t)t();else if(null==e&&a){var r=q().requests.teams.emailInvite.error;a((0,E.default)({id:r.server_error_id},r))}})}function f(e){(0,k.viewChannel)(y.default.getCurrentId())(C,q),b.browserHistory.push(e)}function p(e,t,a){(0,U.getTeamsForUser)(e)(C,q).then(function(e){if(e&&t)t(e);else if(null==e&&a){var r=q().requests.teams.getTeams.error;a((0,E.default)({id:r.server_error_id},r))}})}function v(e,t,a){(0,U.getTeamMembersForUser)(e)(C,q).then(function(e){if(e&&t)t(e);else if(null==e&&a){var r=q().requests.teams.getTeamMembers.error;a((0,E.default)({id:r.server_error_id},r))}})}Object.defineProperty(t,"__esModule",{value:!0});var h=a(112),E=r(h);t.checkIfTeamExists=s,t.createTeam=n,t.updateTeam=l,t.removeUserFromTeam=i,t.updateTeamMemberRoles=o,t.addUserToTeamFromInvite=u,t.addUsersToTeam=d,t.getInviteInfo=m,t.inviteMembers=c,t.switchTeams=f,t.getTeamsForUser=p,t.getTeamMembersForUser=v;var g=a(43),_=r(g),M=a(29),y=r(M),w=a(52),T=r(w),b=a(58),N=a(36),S=r(N),I=a(115),k=a(79),U=a(200),F=a(4),L=a(81),C=S.default.dispatch,q=S.default.getState},1737:function(e,t,a){e.exports=a.p+"files/5d6be4015bde2a4e0358c8bc110deadc.png"}});
//# sourceMappingURL=40.e6f70a151bd223c92f3c.js.map